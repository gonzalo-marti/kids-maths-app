<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperHero Maths</title>
    <style>
        :root {
            --color-primary: rgba(33, 128, 141, 1);
            --color-primary-hover: rgba(29, 116, 128, 1);
            --color-surface: rgba(255, 255, 253, 1);
            --color-text: rgba(19, 52, 59, 1);
            --color-text-secondary: rgba(98, 108, 113, 1);
            --color-border: rgba(94, 82, 64, 0.2);
            --color-success: rgba(33, 128, 141, 1);
            --color-error: rgba(192, 21, 47, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .app-container {
            width: 100%;
            max-width: 800px;
        }

        .screen {
            display: none;
            background: var(--color-surface);
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .screen.active {
            display: block;
        }

        h1 {
            font-size: 36px;
            color: var(--color-primary);
            margin-bottom: 16px;
            text-align: center;
        }

        h2 {
            font-size: 28px;
            color: var(--color-primary);
            margin-bottom: 24px;
            text-align: center;
        }

        .subtitle {
            font-size: 18px;
            color: var(--color-text-secondary);
            margin-bottom: 32px;
            text-align: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 44px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn-secondary {
            background: rgba(94, 82, 64, 0.12);
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .button-group {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 16px 0;
        }

        .user-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .user-card {
            background: rgba(59, 130, 246, 0.08);
            border: 2px solid var(--color-border);
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .user-card:hover {
            transform: translateY(-2px);
            border-color: var(--color-primary);
        }

        .user-avatar {
            font-size: 36px;
            margin-bottom: 12px;
        }

        .user-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .user-stats {
            font-size: 12px;
            color: var(--color-text-secondary);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--color-surface);
            padding: 32px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 12px;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            font-size: 14px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .avatar-selection {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .avatar-option {
            background: rgba(94, 82, 64, 0.12);
            border: 2px solid var(--color-border);
            border-radius: 8px;
            padding: 12px;
            font-size: 24px;
            cursor: pointer;
            text-align: center;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .avatar-option:hover {
            border-color: var(--color-primary);
        }

        .avatar-option.selected {
            background: var(--color-primary);
            border-color: var(--color-primary);
        }

        .question-container {
            background: rgba(59, 130, 246, 0.08);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 2px solid var(--color-border);
        }

        .question-text {
            font-size: 20px;
            margin-bottom: 24px;
            text-align: center;
        }

        .answer-input {
            width: 100%;
            max-width: 300px;
            padding: 12px 16px;
            font-size: 18px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            text-align: center;
            display: block;
            margin: 0 auto 16px;
        }

        .answer-input:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .feedback {
            margin: 16px 0;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
        }

        .feedback.correct {
            background: rgba(33, 128, 141, 0.1);
            color: var(--color-success);
            border: 2px solid var(--color-success);
        }

        .feedback.incorrect {
            background: rgba(192, 21, 47, 0.1);
            color: var(--color-error);
            border: 2px solid var(--color-error);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(245, 158, 11, 0.08);
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            .user-list {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- User Selection Screen -->
        <div class="screen active" id="userScreen">
            <h1>ü¶∏ SuperHero Maths</h1>
            <p class="subtitle">Choose your profile to start learning!</p>
            
            <div id="userList" class="user-list"></div>
            
            <div class="button-group">
                <button class="btn btn-primary" id="createUserBtn">‚ûï Create New User</button>
                <button class="btn btn-secondary" id="parentViewBtn">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Parent View</button>
            </div>
        </div>

        <!-- Practice Screen -->
        <div class="screen" id="practiceScreen">
            <div class="progress-info">
                <div id="questionNumber">Question 1</div>
                <div id="scoreDisplay">Score: 0/0</div>
            </div>
            
            <div class="question-container">
                <div class="question-text" id="questionText">Loading...</div>
                <input type="text" class="answer-input" id="answerInput" name="answer" placeholder="Type your answer...">
                
                <div class="button-group">
                    <button class="btn btn-primary" id="submitBtn" disabled>Submit Answer</button>
                </div>
                
                <div id="feedbackContainer"></div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" id="backBtn">üè† Back to Menu</button>
            </div>
        </div>

        <!-- Parent Dashboard -->
        <div class="screen" id="parentScreen">
            <h2>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Parent Dashboard</h2>
            <div id="parentContent"></div>
            <div class="button-group">
                <button class="btn btn-primary" id="backToMenuBtn">üè† Back to Menu</button>
            </div>
        </div>
    </div>

    <!-- Create User Modal -->
    <div id="createUserModal" class="modal">
        <div class="modal-content">
            <h2>Create New User</h2>
            <div class="form-group">
                <label class="form-label" for="usernameInput">Name:</label>
                <input type="text" class="form-control" id="usernameInput" name="username" placeholder="Enter your name" maxlength="20">
            </div>
            <div class="form-group">
                <label class="form-label">Choose your avatar:</label>
                <div class="avatar-selection" id="avatarSelection"></div>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" id="confirmCreateBtn">Create</button>
                <button class="btn btn-secondary" id="cancelCreateBtn">Cancel</button>
            </div>
        </div>
    </div>

    <script type="module">
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDeCXHxMolX3VxoDiIndMXjEU_EQJ2G_HI",
            authDomain: "superheromaths.firebaseapp.com",
            projectId: "superheromaths",
            storageBucket: "superheromaths.firebasestorage.app",
            messagingSenderId: "695354044143",
            appId: "1:695354044143:web:e78e885474bd1b0693b51a"
        };

        // Global variables
        let db = null;
        let firebaseFunctions = null;
        let users = {};
        let currentUser = null;
        let selectedAvatar = 'üöÄ';
        let currentQuestion = null;
        let score = 0;
        let questionCount = 0;

        const names = ['Nacho', 'Javi', 'Gonza', 'Ignacio', 'Javier', 'Gonzalo', 'Steven', 'Harry', 'Noah', 'Aiden', 'Liam', 'Rafa', 'Sergei', 'Ayana', 'Ramon', 'I√±igo', 'Luis', 'Jaime', 'Thiago', 'Leo', 'Felipe', 'Enrique', 'Sofia', 'Flap', 'Ethan', 'Santi', 'William', 'Kaiser', 'I√±aki', 'Cristina', 'Loreto', 'Macarena', 'Ray', 'Nina', 'Ana', 'Maria', 'Sheina', 'Paloma', 'Totu', 'Gaby'];
        const avatars = ['üöÄ', '‚öΩ', 'üé®', 'üåü', 'üéÆ', 'ü¶Ñ', 'üåà', 'üéØ', '‚≠ê', 'üî•', 'üí´', 'üé™', 'üé≠', 'üé¨', 'üé§', 'üèÄ'];
        
        // Generate all 553 questions
        function generateAllQuestions() {
            const allQuestions = [];
            
            // Basic Addition (50 questions)
            const additionPairs = [
                [2,3], [5,4], [6,2], [3,7], [8,1], [4,5], [7,3], [9,1], [2,6], [5,5],
                [12,8], [15,7], [23,9], [34,16], [27,15], [19,13], [28,14], [36,18], [45,27], [52,29],
                [11,9], [14,6], [17,8], [21,19], [33,17], [25,25], [38,12], [41,29], [46,34], [53,27],
                [16,24], [29,31], [37,23], [44,16], [48,32], [51,19], [55,25], [58,22], [62,18], [67,23],
                [13,17], [26,14], [35,25], [42,28], [49,31], [56,24], [63,27], [71,19], [78,22], [85,15]
            ];
            additionPairs.forEach(([a, b]) => {
                allQuestions.push({
                    question: `What is ${a} + ${b}?`,
                    answer: a + b,
                    type: 'addition'
                });
            });
            
            // Subtraction (80 questions)
            for (let i = 0; i < 80; i++) {
                const a = Math.floor(Math.random() * 50) + 10;
                const b = Math.floor(Math.random() * a);
                allQuestions.push({
                    question: `What is ${a} - ${b}?`,
                    answer: a - b,
                    type: 'subtraction'
                });
            }
            
            // Multiplication (80 questions)
            for (let i = 0; i < 80; i++) {
                const a = Math.floor(Math.random() * 12) + 1;
                const b = Math.floor(Math.random() * 12) + 1;
                allQuestions.push({
                    question: `What is ${a} √ó ${b}?`,
                    answer: a * b,
                    type: 'multiplication'
                });
            }
            
            // Division (60 questions)
            for (let i = 0; i < 60; i++) {
                const b = Math.floor(Math.random() * 12) + 1;
                const result = Math.floor(Math.random() * 12) + 1;
                const a = b * result;
                allQuestions.push({
                    question: `What is ${a} √∑ ${b}?`,
                    answer: result,
                    type: 'division'
                });
            }
            
            // Word Problems (200 questions)
            const wordTemplates = [
                {
                    template: '{name} has {a} apples and buys {b} more. How many apples does {name} have in total?',
                    operation: (a, b) => a + b,
                    type: 'word_addition'
                },
                {
                    template: '{name} had {a} stickers and gave away {b}. How many stickers does {name} have left?',
                    operation: (a, b) => a - b,
                    type: 'word_subtraction'
                },
                {
                    template: '{name} has {a} boxes with {b} toys in each box. How many toys does {name} have altogether?',
                    operation: (a, b) => a * b,
                    type: 'word_multiplication'
                },
                {
                    template: '{name} has {a} candies to share equally among {b} friends. How many candies does each friend get?',
                    operation: (a, b) => Math.floor(a / b),
                    type: 'word_division'
                },
                {
                    template: '{name} reads {a} pages on Monday and {b} pages on Tuesday. How many pages did {name} read in total?',
                    operation: (a, b) => a + b,
                    type: 'word_addition'
                },
                {
                    template: '{name} has {a} marbles and loses {b} of them. How many marbles does {name} have now?',
                    operation: (a, b) => a - b,
                    type: 'word_subtraction'
                },
                {
                    template: '{name} saves ${a} every week for {b} weeks. How much money does {name} save in total?',
                    operation: (a, b) => a * b,
                    type: 'word_multiplication'
                },
                {
                    template: '{name} has {a} cookies to pack into {b} boxes. How many cookies go in each box if divided equally?',
                    operation: (a, b) => Math.floor(a / b),
                    type: 'word_division'
                }
            ];
            
            for (let i = 0; i < 200; i++) {
                const template = wordTemplates[i % wordTemplates.length];
                const name = names[i % names.length];
                let a, b;
                
                if (template.type === 'word_division') {
                    b = Math.floor(Math.random() * 8) + 2;
                    const result = Math.floor(Math.random() * 10) + 1;
                    a = b * result;
                } else {
                    a = Math.floor(Math.random() * 20) + 1;
                    b = Math.floor(Math.random() * 20) + 1;
                    if (template.type === 'word_subtraction' && b > a) {
                        [a, b] = [b, a];
                    }
                }
                
                const questionText = template.template
                    .replace(/\{name\}/g, name)
                    .replace('{a}', a)
                    .replace('{b}', b);
                
                allQuestions.push({
                    question: questionText,
                    answer: template.operation(a, b),
                    type: template.type
                });
            }
            
            // Fractions and Decimals (83 questions to reach 553 total)
            for (let i = 0; i < 43; i++) {
                const numerator = Math.floor(Math.random() * 8) + 1;
                const denominator = Math.floor(Math.random() * 8) + 2;
                
                allQuestions.push({
                    question: `What is ${numerator}/${denominator} as a decimal? (Round to 2 decimal places)`,
                    answer: Math.round((numerator / denominator) * 100) / 100,
                    type: 'fraction'
                });
            }
            
            // More mixed operations (40 questions)
            for (let i = 0; i < 40; i++) {
                const a = Math.floor(Math.random() * 20) + 5;
                const b = Math.floor(Math.random() * 10) + 1;
                const c = Math.floor(Math.random() * 10) + 1;
                
                if (i % 4 === 0) {
                    allQuestions.push({
                        question: `What is ${a} + ${b} - ${c}?`,
                        answer: a + b - c,
                        type: 'mixed'
                    });
                } else if (i % 4 === 1) {
                    allQuestions.push({
                        question: `What is ${a} - ${b} + ${c}?`,
                        answer: a - b + c,
                        type: 'mixed'
                    });
                } else if (i % 4 === 2) {
                    allQuestions.push({
                        question: `What is ${b} √ó ${c} + ${a}?`,
                        answer: b * c + a,
                        type: 'mixed'
                    });
                } else {
                    const divisor = Math.floor(Math.random() * 5) + 2;
                    const dividend = divisor * b;
                    allQuestions.push({
                        question: `What is ${dividend} √∑ ${divisor} + ${c}?`,
                        answer: b + c,
                        type: 'mixed'
                    });
                }
            }
            
            console.log(`‚úÖ Generated ${allQuestions.length} questions`);
            return allQuestions;
        }
        
        const questions = generateAllQuestions();

        // Initialize Firebase
        async function initFirebase() {
            try {
                console.log('Initializing Firebase...');
                const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
                const { getFirestore, collection, doc, setDoc, getDocs, updateDoc } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');
                
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                firebaseFunctions = { collection, doc, setDoc, getDocs, updateDoc };
                
                console.log('‚úÖ Firebase initialized successfully');
                return true;
            } catch (error) {
                console.error('‚ùå Firebase initialization failed:', error);
                alert('Error connecting to database: ' + error.message);
                return false;
            }
        }

        // Save user to Firebase
        async function saveUser(username, userData) {
            if (!db || !firebaseFunctions) {
                throw new Error('Database not connected');
            }
            
            const { doc, setDoc } = firebaseFunctions;
            await setDoc(doc(db, 'users', username), userData);
            console.log('User saved:', username);
        }

        // Load users from Firebase
        async function loadUsers() {
            if (!db || !firebaseFunctions) {
                console.log('Database not connected, skipping load');
                return;
            }
            
            try {
                const { collection, getDocs } = firebaseFunctions;
                const snapshot = await getDocs(collection(db, 'users'));
                
                users = {};
                snapshot.forEach(doc => {
                    users[doc.id] = doc.data();
                });
                
                console.log(`Loaded ${Object.keys(users).length} users`);
                updateUserList();
            } catch (error) {
                console.error('Error loading users:', error);
                alert('Error loading users: ' + error.message);
            }
        }

        // Update user list display
        function updateUserList() {
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            
            if (Object.keys(users).length === 0) {
                userList.innerHTML = '<p style="text-align: center; color: #666;">No users yet! Create your first profile to get started.</p>';
                return;
            }
            
            Object.values(users).forEach(user => {
                const card = document.createElement('div');
                card.className = 'user-card';
                card.innerHTML = `
                    <div class="user-avatar">${user.avatar}</div>
                    <div class="user-name">${user.username}</div>
                    <div class="user-stats">
                        Score: ${user.totalCorrect || 0}/${user.totalAttempted || 0}<br>
                        Points: ${user.totalPoints || 0}
                    </div>
                `;
                card.onclick = () => selectUser(user.username);
                userList.appendChild(card);
            });
        }

        // Show create user modal
        function showCreateUserModal() {
            const modal = document.getElementById('createUserModal');
            modal.classList.add('show');
            
            document.getElementById('usernameInput').value = '';
            document.getElementById('usernameInput').focus();
            
            // Render avatars
            const grid = document.getElementById('avatarSelection');
            grid.innerHTML = '';
            avatars.forEach((emoji, i) => {
                const div = document.createElement('div');
                div.className = 'avatar-option' + (i === 0 ? ' selected' : '');
                div.textContent = emoji;
                div.onclick = function() {
                    document.querySelectorAll('.avatar-option').forEach(el => el.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedAvatar = emoji;
                };
                grid.appendChild(div);
            });
            selectedAvatar = avatars[0];
        }

        // Close modal
        function closeModal() {
            document.getElementById('createUserModal').classList.remove('show');
        }

        // Create user
        async function createUser() {
            const username = document.getElementById('usernameInput').value.trim();
            
            if (!username) {
                alert('Please enter a name');
                return;
            }
            
            if (users[username]) {
                alert('Username already exists');
                return;
            }
            
            try {
                const userData = {
                    username: username,
                    avatar: selectedAvatar,
                    totalPoints: 0,
                    totalCorrect: 0,
                    totalAttempted: 0,
                    createdAt: new Date().toISOString()
                };
                
                await saveUser(username, userData);
                users[username] = userData;
                
                closeModal();
                updateUserList();
                alert(`Welcome, ${username}! üéâ`);
            } catch (error) {
                console.error('Error creating user:', error);
                alert('Error creating user: ' + error.message);
            }
        }

        // Select user and start practice
        function selectUser(username) {
            currentUser = users[username];
            console.log('User selected:', username);
            startPractice();
        }

        // Start practice mode
        function startPractice() {
            score = 0;
            questionCount = 0;
            showScreen('practiceScreen');
            loadNextQuestion();
        }

        // Load next question
        function loadNextQuestion() {
            currentQuestion = questions[Math.floor(Math.random() * questions.length)];
            questionCount++;
            
            document.getElementById('questionNumber').textContent = `Question ${questionCount}`;
            document.getElementById('questionText').textContent = currentQuestion.question;
            document.getElementById('scoreDisplay').textContent = `Score: ${score}/${questionCount - 1}`;
            
            const answerInput = document.getElementById('answerInput');
            answerInput.value = '';
            answerInput.disabled = false;
            answerInput.focus();
            
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('feedbackContainer').innerHTML = '';
        }

        // Submit answer
        async function submitAnswer() {
            const userAnswer = parseFloat(document.getElementById('answerInput').value);
            const correct = userAnswer === currentQuestion.answer;
            
            if (correct) score++;
            
            // Update user stats
            if (currentUser) {
                currentUser.totalAttempted++;
                if (correct) {
                    currentUser.totalCorrect++;
                    currentUser.totalPoints = (currentUser.totalPoints || 0) + 10;
                }
                
                try {
                    await saveUser(currentUser.username, currentUser);
                } catch (error) {
                    console.error('Error saving user:', error);
                }
            }
            
            // Show feedback
            const container = document.getElementById('feedbackContainer');
            const feedback = document.createElement('div');
            feedback.className = `feedback ${correct ? 'correct' : 'incorrect'}`;
            feedback.textContent = correct ? '‚úÖ Correct! Well done!' : `‚ùå Incorrect. The answer is ${currentQuestion.answer}`;
            container.innerHTML = '';
            container.appendChild(feedback);
            
            document.getElementById('scoreDisplay').textContent = `Score: ${score}/${questionCount}`;
            
            // Next question after delay
            setTimeout(loadNextQuestion, 2000);
        }

        // Show parent dashboard
        function showParentDashboard() {
            const password = prompt('üîí Enter parent password:');
            if (password !== '260283') {
                if (password !== null) alert('Incorrect password');
                return;
            }
            
            showScreen('parentScreen');
            
            const content = document.getElementById('parentContent');
            let html = '<h3>User Statistics</h3>';
            
            if (Object.keys(users).length === 0) {
                html += '<p>No users to display.</p>';
            } else {
                Object.values(users).forEach(user => {
                    const accuracy = user.totalAttempted > 0 ? 
                        Math.round((user.totalCorrect / user.totalAttempted) * 100) : 0;
                    
                    html += `
                        <div style="background: rgba(34, 197, 94, 0.08); padding: 16px; margin-bottom: 12px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 2rem;">${user.avatar}</span>
                                <span style="font-weight: 600;">${user.username}</span>
                            </div>
                            <div>
                                ${user.totalCorrect}/${user.totalAttempted} (${accuracy}%) | ${user.totalPoints || 0} pts
                            </div>
                        </div>
                    `;
                });
            }
            
            content.innerHTML = html;
        }

        // Show screen
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        // Back to menu
        function backToMenu() {
            showScreen('userScreen');
        }

        // Main initialization
        async function init() {
            console.log('üöÄ Starting SuperHero Maths...');
            
            // Initialize Firebase first
            const firebaseReady = await initFirebase();
            
            if (!firebaseReady) {
                alert('Cannot connect to database. Please check your internet connection and refresh the page.');
                return;
            }
            
            // Load users
            await loadUsers();
            
            // Set up all event listeners
            document.getElementById('createUserBtn').onclick = showCreateUserModal;
            document.getElementById('parentViewBtn').onclick = showParentDashboard;
            document.getElementById('confirmCreateBtn').onclick = createUser;
            document.getElementById('cancelCreateBtn').onclick = closeModal;
            document.getElementById('backBtn').onclick = backToMenu;
            document.getElementById('backToMenuBtn').onclick = backToMenu;
            
            // Modal click outside to close
            document.getElementById('createUserModal').onclick = function(e) {
                if (e.target === this) closeModal();
            };
            
            // Username input enter key
            document.getElementById('usernameInput').onkeypress = function(e) {
                if (e.key === 'Enter') createUser();
            };
            
            // Answer input
            const answerInput = document.getElementById('answerInput');
            const submitBtn = document.getElementById('submitBtn');
            
            answerInput.oninput = function() {
                submitBtn.disabled = this.value.trim() === '';
            };
            
            answerInput.onkeypress = function(e) {
                if (e.key === 'Enter' && !submitBtn.disabled) {
                    submitAnswer();
                }
            };
            
            submitBtn.onclick = submitAnswer;
            
            console.log('‚úÖ App ready!');
        }

        // Start when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>